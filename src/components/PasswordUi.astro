---

---

<div class="container mx-auto px-4 py-8 max-w-4xl">
    <!-- Header -->
    <div class="text-center mb-12">
        <h1
            class="text-4xl font-bold mb-4 bg-clip-text text-transparent bg-linear-to-r from-primary to-secondary"
        >
            Random Password Generator
        </h1>
        <p class="text-base-content/70">Generate secure, strong passwords.</p>
    </div>

    <!-- Configuration Card -->
    <div class="card bg-base-100 shadow-xl mb-8 border border-base-300">
        <div class="card-body">
            <h2 class="card-title text-2xl mb-4">Configuration</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="form-control">
                    <label class="label" for="passwordLength">
                        <span class="label-text">Length (2-50)</span>
                    </label>
                    <input
                        type="number"
                        id="passwordLength"
                        class="input input-bordered w-full"
                        value="16"
                        min="2"
                        max="50"
                    />
                </div>
                <div class="form-control">
                    <label class="label cursor-pointer justify-start gap-4">
                        <span class="label-text text-base font-medium"
                            >Use Special Characters</span
                        >
                        <input
                            type="checkbox"
                            id="passwordHardened"
                            class="toggle toggle-primary"
                            checked
                        />
                    </label>
                    <div class="text-xs text-base-content/60 mt-2">
                        Adds special characters to harden the password.
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Generated Password Card -->
    <div class="card bg-base-100 shadow-xl mb-8 border border-base-300">
        <div class="card-body">
            <h2 class="card-title text-2xl mb-6">Generated Password</h2>

            <div
                class="flex flex-col md:flex-row gap-4 items-center justify-between p-6 bg-base-200 rounded-box mb-6"
            >
                <code
                    id="passwordOutput"
                    class="text-xl md:text-2xl font-mono break-all text-primary font-bold"
                >
                    <!-- Password will appear here -->
                </code>
                <div class="flex gap-2 shrink-0">
                    <button
                        id="copyBtn"
                        class="btn btn-square btn-ghost"
                        aria-label="Copy Password"
                    >
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            class="h-6 w-6"
                            fill="none"
                            viewBox="0 0 24 24"
                            stroke="currentColor"
                        >
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                stroke-width="2"
                                d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"
                            ></path>
                        </svg>
                    </button>
                    <button
                        id="regenerateBtn"
                        class="btn btn-square btn-ghost"
                        aria-label="Regenerate Password"
                    >
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            class="h-6 w-6"
                            fill="none"
                            viewBox="0 0 24 24"
                            stroke="currentColor"
                        >
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                stroke-width="2"
                                d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"
                            ></path>
                        </svg>
                    </button>
                </div>
            </div>

            <div class="flex justify-end">
                <button
                    id="generateBtn"
                    class="btn btn-primary w-full sm:w-auto min-w-[200px]"
                >
                    Generate
                </button>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div
        id="toast"
        class="toast toast-bottom toast-center transition-opacity duration-300 opacity-0 pointer-events-none"
    >
        <div class="alert alert-info">
            <span id="toastMessage">Message sent successfully.</span>
        </div>
    </div>
</div>

<script>
    import Shifty from "@deepsource/shifty";

    // DOM Elements
    const passwordOutput = document.getElementById("passwordOutput");
    const generateBtn = document.getElementById("generateBtn");
    const regenerateBtn = document.getElementById("regenerateBtn");
    const copyBtn = document.getElementById("copyBtn");

    // Config Elements
    const passwordLengthInput = document.getElementById(
        "passwordLength",
    ) as HTMLInputElement;
    const passwordHardenedInput = document.getElementById(
        "passwordHardened",
    ) as HTMLInputElement;

    function generatePassword() {
        if (!passwordOutput) return;

        const length = Math.min(
            Math.max(parseInt(passwordLengthInput?.value || "16"), 2),
            50,
        );
        const hardened = passwordHardenedInput?.checked || false;

        // Shifty(harden, defaultLength)
        // Note: The package usage in the prompt says: new Shifty((harden = true), (defaultLength = 16))
        // And shifty.generate((length = 12))

        try {
            const shifty = new Shifty(hardened, 16);
            const password = shifty.generate(length);

            passwordOutput.classList.add("opacity-50");
            setTimeout(() => {
                passwordOutput.textContent = password;
                passwordOutput.classList.remove("opacity-50");
            }, 150);
        } catch (e) {
            console.error(e);
            passwordOutput.textContent = "Error generating password";
        }
    }

    generateBtn?.addEventListener("click", generatePassword);
    regenerateBtn?.addEventListener("click", generatePassword);

    copyBtn?.addEventListener("click", () => {
        const text = passwordOutput?.textContent?.trim();
        if (text) {
            copyToClipboard(text);
            showToast("Password copied to clipboard!");
        } else {
            generatePassword();
            setTimeout(() => {
                const newText = passwordOutput?.textContent?.trim();
                if (newText) {
                    copyToClipboard(newText);
                    showToast("Generated & Copied!");
                }
            }, 200);
        }
    });

    // Utilities
    function copyToClipboard(text: string) {
        if (navigator.clipboard && navigator.clipboard.writeText) {
            navigator.clipboard.writeText(text);
        } else {
            const textarea = document.createElement("textarea");
            textarea.value = text;
            textarea.style.position = "fixed";
            textarea.style.opacity = "0";
            document.body.appendChild(textarea);
            textarea.select();
            document.execCommand("copy");
            document.body.removeChild(textarea);
        }
    }

    function showToast(message: string) {
        const toast = document.getElementById("toast");
        const toastMessage = document.getElementById("toastMessage");
        if (toast && toastMessage) {
            toastMessage.textContent = message;
            toast.classList.remove("opacity-0");
            setTimeout(() => toast.classList.add("opacity-0"), 2500);
        }
    }

    // Validation
    passwordLengthInput?.addEventListener(
        "input",
        function (this: HTMLInputElement) {
            let value = parseInt(this.value);
            if (value > 50) this.value = "50";
            if (value < 2 && this.value !== "") {
                // allow check on blur
            }
        },
    );

    passwordLengthInput?.addEventListener(
        "blur",
        function (this: HTMLInputElement) {
            let value = parseInt(this.value);
            if (isNaN(value) || value < 2) this.value = "2";
        },
    );

    // Initial load
    generatePassword();
</script>
